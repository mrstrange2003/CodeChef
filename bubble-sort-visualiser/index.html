<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bubble Sort Visualiser</title>
<style>
  :root{
    --bar-color:#4c8bf5;
    --compare:#facc15;   /* yellow */
    --sorted:#22c55e;    /* green */
    --bg:#0f172a;        /* slate-900 */
    --panel:#ffffff;
    --muted:#64748b;
  }
  *{box-sizing:border-box}
  body{
    margin:0;min-height:100vh;display:grid;place-items:center;
    background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif
  }
  .app{
    width:min(92vw,980px);background:var(--panel);border-radius:14px;padding:18px 18px 22px;
    box-shadow:0 20px 45px rgba(0,0,0,.2)
  }
  h1{margin:0 0 6px;font-size:22px}
  .controls{
    display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:8px 0 14px
  }
  .controls input[type="number"], .controls input[type="text"]{
    height:42px;border:1.5px solid #cbd5e1;border-radius:10px;padding:0 12px;font-size:14px;min-width:160px
  }
  .controls .group{display:flex;gap:10px;align-items:center}
  .controls label{font-size:12px;color:var(--muted)}
  .controls input[type="range"]{width:160px}
  button{
    height:42px;padding:0 14px;border:none;border-radius:10px;cursor:pointer;
    background:#4f46e5;color:#fff;font-weight:600
  }
  button.ghost{background:#f1f5f9;color:#0f172a}
  button:disabled{opacity:.6;cursor:not-allowed}
  #bars-container{
    height:340px;border:1px dashed #e2e8f0;border-radius:12px;background:#f8fafc;
    display:flex;align-items:flex-end;gap:6px;padding:12px;overflow:hidden
  }
  .bar{
    width:20px;background:var(--bar-color);border-radius:6px 6px 0 0;display:flex;align-items:flex-end;justify-content:center;
    transition:height .25s ease;
  }
  .bar-label{font-size:11px;color:#111827;margin-bottom:6px;user-select:none}
  .legend{display:flex;gap:18px;margin-top:10px;color:#334155;font-size:13px}
  .dot{display:inline-block;width:12px;height:12px;border-radius:3px;margin-right:6px;vertical-align:middle}
  .hint{margin-top:6px;color:var(--muted);font-size:12px}
  @media (max-width:700px){
    .bar{width:12px}
    #bars-container{gap:4px}
  }
</style>
</head>
<body>
  <div class="app">
    <h1>Bubble Sort Visualiser</h1>

    <div class="controls">
      <input type="number" id="size" placeholder="Array Size (e.g., 20)" min="1" />
      <input type="text" id="elements" placeholder="Enter elements (comma separated)" />
      <button id="generate">Generate Bars</button>
      <button id="sort">Start Sorting</button>
      <button id="shuffle" class="ghost">Shuffle</button>

      <div class="group">
        <label for="speed">Speed</label>
        <input type="range" id="speed" min="50" max="1200" value="600" />
      </div>
    </div>

    <div id="bars-container"></div>

    <div class="legend">
      <span><i class="dot" style="background:#4c8bf5"></i>Unsorted</span>
      <span><i class="dot" style="background:#facc15"></i>Comparing</span>
      <span><i class="dot" style="background:#22c55e"></i>Sorted</span>
    </div>
    <div class="hint">Tip: provide either a size (creates random values 1–99) or a custom comma list.</div>
  </div>

<script>
  // ---- Elements
  const sizeInput     = document.getElementById("size");
  const elementsInput = document.getElementById("elements");
  const generateBtn   = document.getElementById("generate");
  const sortBtn       = document.getElementById("sort");
  const shuffleBtn    = document.getElementById("shuffle");
  const speedInput    = document.getElementById("speed");
  const barsContainer = document.getElementById("bars-container");

  let arr = [];

  // ---- Helpers
  const sleep = (ms) => new Promise(r => setTimeout(r, ms));
  const currentDelay = () => parseInt(speedInput.value, 10);

  function disableControls(disabled){
    generateBtn.disabled = disabled;
    sortBtn.disabled     = disabled;
    shuffleBtn.disabled  = disabled;
    sizeInput.disabled   = disabled;
    elementsInput.disabled = disabled;
    speedInput.disabled  = disabled && arr.length === 0; // keep speed usable if nothing on screen
  }

  // ---- Rendering
  function renderBars(values){
    barsContainer.innerHTML = "";
    values.forEach(v => {
      const bar = document.createElement("div");
      bar.className = "bar";
      bar.style.height = (v * 3) + "px";      // scale factor
      const label = document.createElement("div");
      label.className = "bar-label";
      label.textContent = v;
      bar.appendChild(label);
      barsContainer.appendChild(bar);
    });
  }

  // ---- Generate / Shuffle
  function generateArray(){
    arr = [];
    const text = elementsInput.value.trim();
    const n = parseInt(sizeInput.value, 10);

    if (text){
      arr = text.split(",").map(s => parseInt(s.trim(),10)).filter(x => !Number.isNaN(x));
      if (arr.length === 0){ alert("No valid numbers found."); return; }
    } else if (Number.isInteger(n) && n > 0){
      for (let i=0;i<n;i++) arr.push(1 + Math.floor(Math.random()*99));
    } else {
      alert("Enter an array size or comma-separated elements.");
      return;
    }
    renderBars(arr);
  }

  function shuffleArray(){
    if (arr.length === 0) return;
    for (let i = arr.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    renderBars(arr);
  }

  // ---- Bubble Sort Animation
  async function bubbleSort(){
    if (arr.length === 0){ alert("Generate bars first."); return; }
    disableControls(true);

    const bars = () => document.querySelectorAll(".bar"); // live on re-render

    // Reset all bars to unsorted color
    bars().forEach(b => b.style.backgroundColor = "#4c8bf5");

    for (let i = 0; i < arr.length - 1; i++){
      for (let j = 0; j < arr.length - i - 1; j++){
        // highlight the two being compared
        bars()[j].style.backgroundColor     = "#facc15";
        bars()[j+1].style.backgroundColor   = "#facc15";

        await sleep(currentDelay());

        if (arr[j] > arr[j+1]){
          // swap values in the data
          [arr[j], arr[j+1]] = [arr[j+1], arr[j]];

          // update heights + labels
          const bj  = bars()[j];
          const bj1 = bars()[j+1];

          bj.style.height  = (arr[j] * 3) + "px";
          bj1.style.height = (arr[j+1] * 3) + "px";

          bj.querySelector(".bar-label").textContent  = arr[j];
          bj1.querySelector(".bar-label").textContent = arr[j+1];
        }

        // revert compare color back to unsorted blue
        bars()[j].style.backgroundColor   = "#4c8bf5";
        bars()[j+1].style.backgroundColor = "#4c8bf5";
      }

      // mark last sorted bar in this pass
      bars()[arr.length - i - 1].style.backgroundColor = "#22c55e";
    }

    // all sorted → turn every bar green
    bars().forEach(b => b.style.backgroundColor = "#22c55e");

    disableControls(false);
  }

  // ---- Events
  generateBtn.addEventListener("click", generateArray);
  shuffleBtn.addEventListener("click", shuffleArray);
  sortBtn.addEventListener("click", bubbleSort);

  // Convenience: Enter in elements box triggers generate
  elementsInput.addEventListener("keydown", e => {
    if (e.key === "Enter") generateArray();
  });
</script>
</body>
</html>
